import PullBatchableQueue from './PullBatchableQueue';
import PushBatchableQueue from './PushBatchableQueue';
import { ResilienceMechanism } from './types';
// Enum isnt just a type, its also an object that needs to be
// exported as an object.
export { ResilienceMechanism };
export default ((retryQueuePrefix, flushCallback, product, options) => {
  switch (options.resilienceMechanism) {
    case ResilienceMechanism.INDEXEDDB:
      return new PullBatchableQueue(flushCallback, product, options);

    case ResilienceMechanism.LOCALSTORAGE:
    default:
      return new PushBatchableQueue(retryQueuePrefix, options, flushCallback);
  }
});